<!doctype html>
  <html lang=en>
  <head>
    <meta charset=utf-8>
    <meta name="viewport" content="width=device-width">
    <meta name="mobile-web-app-capable" content="yes">

    <title>candy pie playgrond</title>

    <style>
      body {
        padding-left: 10px;
        color: steelblue;
        max-width: 600px;
        margin: auto;
        border: 1px solid lightgrey;
      }

      .configOption {
        display: inline-block;
        width: 50%;
        margin: 8px;
      }

      input[type="number"] {
        width: 15%;
      }

      .candy-pie-babylon-canvas {
        touch-action: none;
        outline: none;
        width: 80%;
        margin-left: 10%;
        margin-bottom: 30px;
      }

      .btn {
        width: 80%;
        margin-left: 10%;
        background-color: lightblue;
        padding-top: 20px;
        padding-bottom: 20px;
        margin-bottom: 25px;
        border: none;
        box-shadow: 3px 7px steelblue;
        font-weight: bold;
        font-size: 24px;
        color: steelblue;
      }

      .btn-plus {
        margin-left: 10%;
        padding-top: 10px;
        padding-bottom: 10px;
        margin-bottom: 10px;
      }

      #slices-id {
        margin: 20px;
      }
    </style>

    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="./candy-pie-babylon.js"></script>

    <link href="https://unpkg.com/tabulator-tables/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables/dist/js/tabulator.min.js"></script>

  </head>
  
  <body>

    <h2>candy pie playground</h2>

    <h3>candy pie</h3>

      <h4 style="margin: 5%;">a configurable, interactive 3d pie chart in your browser</h4>

      <ul style="margin: 5%;">
        <li>open source repository on <a href="https://github.com/thierryVergult/CandyPie" target="_blank">github</a></li>
        <li><a href="https://thierryvergult.github.io/CandyPie/" target="_blank">for more examples &amp; details</a></li>
        <br>
        <li><a href="http://tabulator.info/" target="_blank">tabulator</a> for the interactive table below</li>
      </ul>

    <h3>data for the slices</h3>

      <p style="margin: 5%;">You can modify all data in the table below. Each row corresponds to a slice of the candy pie.</p>

      <div id="slices-id"></div>
    
      <button onclick="table.addRow( {}, false);" class="btn-plus">Add row</button>

      <p style="margin-left: 10%; margin-right: 10%;">Set <i>height</i> or <i>ArcPct</i> to zero to remove a slice from the candy pie</p>
      <p style="margin-left: 10%; margin-right: 10%;">You can type the name of a color, like <i>yellow</i>, in the <i>color</i> column, or type there the hexadecimal value, like <i>#000000</i> (for black).</p>

    <h3>candy pie</h3>
    <canvas id='canvas-id' class='candy-pie-babylon-canvas'></canvas>

    <button onclick="pie3d.slices = table.getData(); candy_pie_babylon( pie3d);" class="btn">Update Candy Pie</button>

    <h3>configuration</h3>

    <p class="configOption">innerRadiusPct</p>
      <input type="number" name="innerRadiusPct"  min="0" max="99" onchange="pie3d[this.name] = this.value;">
      <span>%</span>
      <br>

    <p class="configOption">spaceBetweenSlices</p>
      <label>false</label><input type="radio" name="spaceBetweenSlices" value="0" onchange="pie3d[this.name] = Boolean( Number(this.value));">
      <label>true </label><input type="radio" name="spaceBetweenSlices" value="1" onchange="pie3d[this.name] = Boolean( Number(this.value));">
      <br>

    <p class="configOption">backgroundColor</p>
      <input type="color" name="backgroundColor" value="#e66465" onchange="pie3d[this.name] = this.value;">
      <br>

    <p class="configOption">secondsPerRotation</p>
      <input type="number" name="secondsPerRotation" min="0" max="100" onchange="pie3d[this.name] = this.value;">
      <span>s</span>
      <br>
    
    <p class="configOption">clickScalePct</p>
      <input type="number" name="clickScalePct" min="0" max="100" onchange="pie3d[this.name] = this.value;">
      <span>%</span>
      <br>
    
    <p class="configOption">allowVerticalRotation</p>
      <label>false</label><input type="radio" name="allowVerticalRotation" value="0" onchange="pie3d[this.name] = Boolean( Number(this.value));">
      <label>true </label><input type="radio" name="allowVerticalRotation" value="1" onchange="pie3d[this.name] = Boolean( Number(this.value));">
      <br>

    <p class="configOption">cameraDegreesY</p>
      <input type="number" name="cameraDegreesY"  min="0" max="90" onchange="pie3d[this.name] = this.value;">
      <span>&deg;</span>
      <ul>
        <li>0 &deg; : you see a rectangle, looking at the front surface of the slices
        <li>90 &deg; : you see the pie chart from above, the pie becomes a circle
      </ul>
    
    <p class="configOption">verticalFactor</p>
      <input type="number" name="verticalFactor"  min="1" max="10" onchange="pie3d[this.name] = this.value;">
      <br>
      <br><br>

    <button onclick="pie3d.slices = table.getData(); candy_pie_babylon( pie3d);" class="btn">Update Candy Pie</button>

    <h3>labels</h3>

    <p class="configOption">showLabel</p>
      <label>false</label><input type="radio" name="showLabel" value="0" onchange="pie3d[this.name] = Boolean( Number(this.value));">
      <label>true </label><input type="radio" name="showLabel" value="1" onchange="pie3d[this.name] = Boolean( Number(this.value));">
      <br>

    <p class="configOption">showHeight</p>
      <label>false</label><input type="radio" name="showHeight" value="0" onchange="pie3d[this.name] = Boolean( Number(this.value));">
      <label>true </label><input type="radio" name="showHeight" value="1" onchange="pie3d[this.name] = Boolean( Number(this.value));">
      <br>

    <p class="configOption">labelFontFactor</p>
      <input type="number" name="labelFontFactor"  min="1" max="5" onchange="pie3d[this.name] = this.value;">  
      <br>
    
    <p class="configOption">labelColor</p>
      <input type="color" name="labelColor" onchange="pie3d[this.name] = this.value;">
      <br>
      <p style="margin-left: 10%; margin-right: 10%;">By default, black or white is chosen per slice, for the best contrast against the color of the slice. A yellow slice will have a black label, a blue slice a white label.</p>
      <p style="margin-left: 10%; margin-right: 10%;">Setting the label color here is for all slices.</p>

    <p class="configOption">labelExtraTopMargin</p>
      <input type="number" name="labelExtraTopMargin"  min="1" max="50" onchange="pie3d[this.name] = this.value;">  
      <br>
    
    <script>
      let pie3d = {
        htmlCanvasId: 'canvas-id',
        slices: [
          { height: 100, color: 'indianred'},
          { height: 100, color: 'steelblue'},
          { height: 100, color: 'olive'}
        ],
        spaceBetweenSlices: false,
        innerRadiusPct: 40,
        backgroundColor: '#d3d3d3',
        secondsPerRotation: 3,
        showLabel: true
      };
              
      candy_pie_babylon( pie3d);

      // push the pie3d values to the configuration elements above
      
      document.getElementsByName("spaceBetweenSlices")[Number(pie3d.spaceBetweenSlices)].checked = true;
      document.getElementsByName("innerRadiusPct")[0].value = pie3d.innerRadiusPct;
      document.getElementsByName("backgroundColor")[0].value = pie3d.backgroundColor;
      document.getElementsByName("secondsPerRotation")[0].value = pie3d.secondsPerRotation;
      document.getElementsByName("clickScalePct")[0].value = pie3d.clickScalePct;
      document.getElementsByName("allowVerticalRotation")[Number(pie3d.allowVerticalRotation)].checked = true;
      document.getElementsByName("verticalFactor")[0].value = pie3d.verticalFactor;
      document.getElementsByName("cameraDegreesY")[0].value = pie3d.cameraDegreesY;

      document.getElementsByName("showLabel")[Number(pie3d.showLabel)].checked = true;
      document.getElementsByName("showHeight")[Number(pie3d.showHeight)].checked = true;
      document.getElementsByName("labelFontFactor")[0].value = pie3d.labelFontFactor;
      document.getElementsByName("labelExtraTopMargin")[0].value = pie3d.labelExtraTopMargin;
      document.getElementsByName("labelColor")[0].value = pie3d.labelColor;

      var table = new Tabulator("#slices-id", {
        data: pie3d.slices,
        layout: "fitColumns",
        columns:[
          { title: "height", field: "height", headerSort: false, resizable: false, editor: "number", headerHozAlign: "right", hozAlign: "right"},
          { title: "color",  field: "color" , headerSort: false, resizable: false, editor: true, headerHozAlign: "left", formatter: "color"},
          { title: "arcPct", field: "arcPct", headerSort: false, resizable: false, editor: "number", headerHozAlign: "right", hozAlign: "right", editorParams: { min: 0, max: 100 }},
          { title: "label",  field: "label",  headerSort: false, resizable: false, editor: true, headerHozAlign: "left"}
        ]
      });

    </script>
  </body>
</html>